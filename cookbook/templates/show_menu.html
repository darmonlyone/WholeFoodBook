{% load diplay_tag static %}
<div class="container content">
    <div class="row" id="category-content">
        <!-- filter tab -->
        <div class="col-md-5 col-lg-3" id="filterby">

            <div class="row" id="filterby">
                <div id="timeprep">
                    <div id="header">TIME PREP</div>
                    <hr>
                </div>
                <div class="row" align="left" id="time-checkbox">
                    <div class="col-md-6">

                        <label class="containerfilter">15 minutes
                            <input type="checkbox" class="check time-but" id="t15-min" value="15-min">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">1 Hour
                            <input type="checkbox" class="check time-but" id="t1-hr" value="1-hr">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">2 Hours
                            <input type="checkbox" class="check time-but" id="t2-hr" value="2-hr">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                    <div class="col-md-6">
                        <label class="containerfilter">30 minutes
                            <input type="checkbox" class="check time-but" id="t30-min" value="30-min">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">1 Half Hours
                            <input type="checkbox" class="check time-but" id="t1-hr-30-min" value="1-hr-30-min">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">Over 2 hrs
                            <input type="checkbox" class="check time-but" id="tmore-than-2-hr" value="more-than-2-hr">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                </div>

                <div id="Equipment">
                    <div id="header">EQUIPMENT</div>
                    <hr>
                </div>
                <div class="row" align="left" id="equipment-checkbox">
                    <div class="col-md-6">

                        <label class="containerfilter">Oven
                            <input type="checkbox" class="check equip-but" id="oven" value="oven">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">Microwave
                            <input type="checkbox" class="check equip-but" id="microwave" value="microwave">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                    <div class="col-md-6">
                        <label class="containerfilter">Mixer
                            <input type="checkbox" class="check equip-but" id="mixer" value="mixer">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">Blender
                            <input type="checkbox" class="check equip-but" id="blender" value="blender">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                </div>


                <div id="allergies">
                    <div id="header">ALLERGIES</div>
                    <hr>
                </div>
                <div class="row" align="left" id="allergies-checkbox">
                    <div class="col-md-6">

                        <label class="containerfilter">Nuts
                            <input type="checkbox" class="check aller-but" id="nuts" value="nut">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">Milk
                            <input type="checkbox" class="check aller-but" id="milk" value="milk">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">Shrimp
                            <input type="checkbox" class="check aller-but" id="shrimp" value="shrimp">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                    <div class="col-md-6">
                        <label class="containerfilter">Shellfish
                            <input type="checkbox" class="check aller-but" id="shellfish" value="shellfish">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">Soy
                            <input type="checkbox" class="check aller-but" id="soy" value="soy">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerfilter">Egg
                            <input type="checkbox" class="check aller-but" id="egg" value="egg">
                            <span class="checkmark"></span>
                        </label>
                    </div>
                </div>

                <div id="Rating">
                    <div id="header">RATING</div>
                    <hr>
                </div>


                <button type="button" onclick="filterRecipe()" class="btn btn-light btn-lg btn-block" id="filter-but">Filter By</button>
                <button type="button" onclick="clearAllFilter()" class="btn btn-secondary btn-lg btn-block" id="clear-but">Clear Filter</button>
            </div>
        </div>

        <script>
            function clearAllFilter(){
                let allLi = document.getElementsByTagName("li");
                for (let i = 0 ; i < allLi.length; i++){
                    allLi[i].classList.remove('unselected')
                }
            }
            function filterRecipe(){
                let allTimeCheckbox = document.getElementById("time-checkbox").getElementsByTagName("input");
                let equipmentCheckbox = document.getElementById("equipment-checkbox").getElementsByTagName("input");
                let allergiesCheckbox = document.getElementById("allergies-checkbox").getElementsByTagName("input");
                let allTimeEquipment = [];

                for (let i = 0 ; i < allTimeCheckbox.length; i++){
                   if(allTimeCheckbox[i].checked === true) {
                        allTimeEquipment.push(allTimeCheckbox[i].value)
                    }
                }
                for (let i = 0 ; i < equipmentCheckbox.length; i++){
                   if(equipmentCheckbox[i].checked === true) {
                        allTimeEquipment.push(equipmentCheckbox[i].value)
                    }
                }

                let allAllergies = [];
                let listAllAllergis = [];
                for (let i = 0 ; i < allergiesCheckbox.length; i++){
                   if(allergiesCheckbox[i].checked === true) {
                        allAllergies.push(allergiesCheckbox[i].value)
                    }else {
                       listAllAllergis.push(document.getElementsByClassName(allergiesCheckbox[i].value));
                   }
                }

                let allLi = document.getElementsByTagName("li");
                for (let i = 0 ; i < allLi.length; i++){
                    allLi[i].classList.add('unselected')
                }

                for (let i = 0; i < listAllAllergis.length; i++){
                    for (let j = 0 ; j < listAllAllergis[i].length; j++){
                        listAllAllergis[i][j].classList.remove('unselected')
                    }
                }

                for (let i = 0 ; i < allLi.length; i++){
                   for (let j = 0 ; j < allTimeEquipment.length; j++){
                       if (allLi[i].classList.contains(allTimeEquipment[j])){
                           allLi[i].classList.remove('unselected')
                       }
                   }
                }
            }
        </script>

        <style>
            .unselected {
                display:none;
                width: 0;
                height: 0;
            }
        </style>
        <!-- แสดงเมนู -->
        <div class="col-md-7 col-lg-9" id="display-food">
            <ul id="">

                    {% for recipe in recipe_show %}
                        <li class="{{ recipe.get_all_tag_str }}">
                    <div class="card food-card">
                        <a href="{% url 'cookbook:recipe' recipe.get_recipe_name %}" style="color:black; text-decoration:none;">
                            {% if recipe.get_recipe_image_1 %}
                            <img class="card-img-top" src="{{ recipe.get_recipe_image_1.url }}" alt="Card image cap">
                            {% else %}
                                <img class="card-img-top" src="{% static 'image/noimage.jpg' %}" alt="Card image cap">
                            {% endif %}
                            <div class="card-body">
                                <strong>{{ recipe.get_recipe_name }}</strong>
                                <p class="card-text {%replace_text_space recipe.get_recipe_name%}">{% cut_text_newline recipe.get_recipe_info %}</p>
                                <p style="float:left;">{{ recipe.get_recipe_chef }}</p>
                            </div>
                        </a>
                    </div>
                        </li>
                    {% endfor %}

            </ul>
        </div>

    </div>

</div>